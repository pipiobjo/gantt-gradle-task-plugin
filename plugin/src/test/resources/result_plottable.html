<html>
<head>
    <title>hello-world build gantt chart</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/plottable@3.8.6/plottable.css" integrity="sha256-TvkZCYltzA24c02PFZmkQq3cJXq4yyJtFs8fGxoBQyc=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/plottable@3.8.6/plottable.js" integrity="sha256-XNPltCAXpmJenIfFTa6kUKZM00K6T5+plDbrpEKd3Pw=" crossorigin="anonymous"></script>
    <!--<script src="https://cdn.jsdelivr.net/npm/plottable@3/plottable.min.js" sync></script>  TODO use plugin property -->
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: sans-serif;
        }

        h2 {
            text-align: center;
            margin: 5px 0;
        }

        #chart-container {
            position: absolute;
            padding-top: 10px;
            padding-bottom: 10px;
            left: 10px;
            right: 10px;
        }

        input, label{
            vertical-align: middle;
        }

        input[type=number] {
            width: 100px;
        }
    </style>
</head>

<body>
<h2>hello-world</h2>
<div>
    <input type="checkbox" id="hideDust"/><label for="hideDust">Hide tasks shorter than</label>
    <input type="number" id="dustThresholdMs" min="0"><label for="dustThresholdMs">ms</label>
    <label for="dustThresholdPercent">(</label><input type="number" id="dustThresholdPercent" min="0" max="100"><label for="dustThresholdPercent">%)</label>
</div>
<div id="chart-container"></div>
<script>
    var data = [
  {
    "name": ":testClasses",
    "start": 1231,
    "end": 1231,
    "deps": [
      ":processTestResources",
      ":compileTestJava"
    ]
  },
  {
    "name": ":build",
    "start": 1237,
    "end": 1237,
    "deps": [
      ":check",
      ":assemble"
    ]
  },
  {
    "name": ":check",
    "start": 1236,
    "end": 1236,
    "deps": [
      ":taskB",
      ":test"
    ]
  },
  {
    "name": ":assemble",
    "start": 1206,
    "end": 1206,
    "deps": [
      ":jar"
    ]
  },
  {
    "name": ":classes",
    "start": 1114,
    "end": 1115,
    "deps": [
      ":compileJava",
      ":processResources"
    ]
  },
  {
    "name": ":jar",
    "start": 1152,
    "end": 1201,
    "deps": [
      ":classes"
    ]
  },
  {
    "name": ":taskB",
    "start": 1224,
    "end": 1224,
    "deps": [
      ":taskA"
    ]
  },
  {
    "name": ":taskA",
    "start": 1208,
    "end": 1222,
    "deps": []
  }
];
</script>

<script>

//
///- REQUIRE FN
// equivalent to require from node.js
function require(url){
    if (url.toLowerCase().substr(-3)!=='.js') url+='.js'; // to allow loading without js suffix;
    if (!require.cache) require.cache=[]; //init cache
    var exports=require.cache[url]; //get from cache
    if (!exports) { //not cached
            try {
                exports={};
                var X=new XMLHttpRequest();
                X.open("GET", url, 0); // sync
                X.send();
                if (X.status && X.status !== 200)  throw new Error(X.statusText);
                var source = X.responseText;
                // fix (if saved form for Chrome Dev Tools)
                if (source.substr(0,10)==="(function("){ 
                    var moduleStart = source.indexOf('{');
                    var moduleEnd = source.lastIndexOf('})');
                    var CDTcomment = source.indexOf('//@ ');
                    if (CDTcomment>-1 && CDTcomment<moduleStart+6) moduleStart = source.indexOf('\n',CDTcomment);
                    source = source.slice(moduleStart+1,moduleEnd-1); 
                } 
                // fix, add comment to show source on Chrome Dev Tools
                source="//@ sourceURL="+window.location.origin+url+"\n" + source;
                //------
                var module = { id: url, uri: url, exports:exports }; //according to node.js modules 
                var anonFn = new Function("require", "exports", "module", source); //create a Fn with module code, and 3 params: require, exports & module
                anonFn(require, exports, module); // call the Fn, Execute the module
                require.cache[url]  = exports = module.exports; //cache obj exported by module
            } catch (err) {
                throw new Error("Error loading module "+url+": "+err);
            }
    }
    return exports; //require returns object exported by module
}
///- END REQUIRE FN

</script>

<script>
    var Plottable = require("https://cdn.jsdelivr.net/npm/plottable@3/plottable.min.js");

   var colorScale = new Plottable.Scales.Color();

var xScale = new Plottable.Scales.Time();
var xAxis = new Plottable.Axes.Time(xScale, "bottom");

var yScale = new Plottable.Scales.Category();
var yAxis = new Plottable.Axes.Category(yScale, "left");

var plot = new Plottable.Plots.Rectangle()
  .x(function(d) { return new Date(d.start); }, xScale)
  .x2(function(d) { return new Date(d.end); })
  .y(function(d) { return d.name; }, yScale)
  .attr("fill", function(d) { return d.name; }, colorScale)
  .addDataset(new Plottable.Dataset(data));

var chart = new Plottable.Components.Table([
  [yAxis, plot],
  [null, xAxis]
]);

chart.renderTo("#chart-container");
</script>
</body>
</html>
